---
jupytext:
  text_representation:
    extension: .md
    format_name: myst
kernelspec:
  display_name: Python 3
  language: python
  name: python3
---

# 博弈论基础

本讲座介绍博弈论的基本概念及其在经济决策中的应用。我们将探讨策略互动、纳什均衡和常见的博弈结构。

## 策略思维导论

博弈论为分析多个决策者策略性互动的情形提供了一个框架。每个参与者的最优选择取决于其他人的选择，从而产生复杂的相互依赖关系。

在经济市场中，企业在价格或产量上竞争就是在进行策略博弈。理解这些互动有助于预测市场结果并设计更好的机制。

## 囚徒困境

经典的囚徒困境说明了为什么理性个体可能不会合作，即使合作对每个人都有利。两名嫌疑人被分开审讯，必须决定是坦白还是保持沉默。

收益矩阵捕捉了策略结构：

|                | 合作        | 背叛        |
|----------------|-------------|-------------|
| **合作**       | (-1, -1)    | (-3, 0)     |
| **背叛**       | (0, -3)     | (-2, -2)    |

每个参与者都有背叛的主导策略，导致双方都处于次优结果。

### 现实世界应用

囚徒困境结构出现在许多经济背景中：
- 企业之间的价格竞争
- 公共物品供给
- 环境保护协议
- 军备竞赛和军事开支

理解这个博弈有助于解释市场失灵以及对监管或合作机制的需求。

## 纳什均衡

纳什均衡是一种策略组合，其中没有参与者可以通过单方面改变策略来改善其收益。它代表了一个稳定的结果，每个参与者的策略在给定其他人策略的情况下都是最优的。

在数学上，对于参与者 $i = 1, \ldots, n$，具有策略集 $S_i$ 和收益函数 $u_i$，策略组合 $(s_1^*, \ldots, s_n^*)$ 是纳什均衡当且仅当：

$$
u_i(s_i^*, s_{-i}^*) \geq u_i(s_i, s_{-i}^*) \quad \forall s_i \in S_i, \forall i
$$

让我们用 Python 计算一个简单博弈的纳什均衡：

```{code-cell} python
import numpy as np
import nashpy as nash

# 定义一个简单的 2x2 博弈
# 参与者1的收益矩阵
A = np.array([[3, 0],
              [5, 1]])

# 参与者2的收益矩阵
B = np.array([[3, 5],
              [0, 1]])

# 创建博弈
game = nash.Game(A, B)

# 找到纳什均衡
equilibria = list(game.support_enumeration())

print("纳什均衡：")
for eq in equilibria:
    print(f"参与者1：{eq[0]}，参与者2：{eq[1]}")
    print(f"收益：({np.dot(eq[0], A @ eq[1])}, {np.dot(eq[0], B.T @ eq[1])})")
    print()
```

### 混合策略

当不存在纯策略纳什均衡时，参与者可能对策略进行随机化。这些混合策略均衡需要无差异条件，使得参与者愿意进行随机化。

混合策略均衡概率可以通过求解以下方程计算：

```{math}
\begin{align}
p \cdot u_1(\text{策略1}) &= p \cdot u_1(\text{策略2}) \\
q \cdot u_2(\text{策略1}) &= q \cdot u_2(\text{策略2})
\end{align}
```

## 序贯博弈

在序贯博弈中，参与者按特定顺序行动并观察之前的行动。这些博弈使用逆向归纳法进行分析，从博弈树的末端回溯到开始。

关键见解是子博弈完美：在每个决策节点上，参与者在给定未来博弈的情况下进行最优选择。这消除了理性参与者不会执行的不可信威胁。

### 斯塔克尔伯格竞争

一个经典应用是斯塔克尔伯格竞争，其中一家企业（领导者）首先选择产量，另一家企业（追随者）在观察到这一选择后再做决定。

领导者预期追随者的反应函数并进行最优选择：

$$
\max_{q_L} \pi_L(q_L, R(q_L))
$$

其中 $R(q_L)$ 是追随者对领导者产量 $q_L$ 的最佳反应。

让我们用数值方法求解斯塔克尔伯格博弈：

```{code-cell} python
from scipy.optimize import minimize_scalar

# 市场参数
a = 100  # 需求截距
c = 10   # 边际成本

# 追随者的反应函数：q_F = (a - c - q_L) / 2
def follower_response(q_L):
    return (a - c - q_L) / 2

# 给定追随者反应的领导者利润
def leader_profit(q_L):
    q_F = follower_response(q_L)
    price = a - q_L - q_F
    return -(price - c) * q_L  # 最小化的负值

# 找到领导者的最优产量
result = minimize_scalar(leader_profit, bounds=(0, a-c), method='bounded')
q_L_optimal = result.x
q_F_optimal = follower_response(q_L_optimal)

print(f"领导者产量：{q_L_optimal:.2f}")
print(f"追随者产量：{q_F_optimal:.2f}")
print(f"市场价格：{a - q_L_optimal - q_F_optimal:.2f}")
print(f"领导者利润：{-result.fun:.2f}")
```

## 重复博弈

当博弈被重复进行时，通过声誉和惩罚机制会出现新的均衡。无名氏定理表明，当参与者足够有耐心时，许多结果可以作为均衡被维持。

关键机制是如果有人偏离合作路径，就威胁回到非合作博弈。这需要：

1. 参与者重视未来收益（贴现因子 $\delta < 1$）
2. 偏离是可观察的
3. 惩罚威胁是可信的

### 触发策略

一个常见的执行机制是冷酷策略：合作直到有人背叛，然后永远背叛。当满足以下条件时，这种策略可以维持合作：

$$
\frac{1}{1-\delta} \cdot \pi_{\text{coop}} \geq \pi_{\text{deviate}} + \frac{\delta}{1-\delta} \cdot \pi_{\text{punish}}
$$

左侧是永久合作的收益，而右侧是偏离的收益加上永久惩罚的收益。

## 练习

1. **计算均衡**：找出以下博弈的所有纳什均衡（纯策略和混合策略）：
   
   |           | 左    | 右    |
   |-----------|-------|-------|
   | **上**    | (3,2) | (1,3) |
   | **下**    | (0,1) | (2,4) |

2. **重复博弈**：使用冷酷策略计算在无限重复囚徒困境中维持合作所需的最小贴现因子。

3. **序贯博弈**：求解三阶段进入博弈的子博弈完美均衡，其中企业依次决定是否进入市场。

4. **混合策略**：验证你在练习1中计算的混合策略均衡使得两个参与者对其纯策略无差异。